{"ast":null,"code":"import{useState,useEffect}from'react';import API from'../API';// Helpers\nimport{isPersistedState}from'../helpers';export const useMovieFetch=movieId=>{const[state,setState]=useState({});const[loading,setLoading]=useState(true);const[error,setError]=useState(false);useEffect(()=>{const fetchMovie=async()=>{try{setLoading(true);setError(false);const movie=await API.fetchMovie(movieId);const credits=await API.fetchCredits(movieId);// Get directors only\nconst directors=credits.crew.filter(member=>member.job==='Director');setState({...movie,actors:credits.cast,directors});setLoading(false);}catch(error){setError(true);}};const sessionState=isPersistedState(movieId);if(sessionState){setState(sessionState);setLoading(false);return;};fetchMovie();},[movieId]);// Write to sessionStorage\nuseEffect(()=>{sessionStorage.setItem(movieId,JSON.stringify(state));},[movieId,state]);return{state,loading,error};};","map":{"version":3,"names":["useState","useEffect","API","isPersistedState","useMovieFetch","movieId","state","setState","loading","setLoading","error","setError","fetchMovie","movie","credits","fetchCredits","directors","crew","filter","member","job","actors","cast","sessionState","sessionStorage","setItem","JSON","stringify"],"sources":["/Users/mohammadravoof/Documents/GitHub/react-rmdb-v3-starter-files/react-rmdb/src/hooks/useMovieFetch.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport API from '../API';\n// Helpers\nimport { isPersistedState } from '../helpers';\n\nexport const useMovieFetch = movieId => {\n    const [state, setState] = useState({});\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(false);\n\n    useEffect (() => {\n        const fetchMovie = async () => {\n            try{\n                setLoading(true);\n                setError(false);\n\n                const movie = await API.fetchMovie(movieId);\n                const credits = await API.fetchCredits(movieId);\n                // Get directors only\n                const directors = credits.crew.filter(\n                    member => member.job === 'Director'\n                );\n\n                setState({\n                    ...movie,\n                    actors: credits.cast,\n                    directors\n                })\n\n                setLoading(false);\n\n            } catch (error) {\n                setError(true);\n            }\n        };\n            \n        const sessionState = isPersistedState(movieId);\n        if (sessionState) {\n            setState(sessionState);\n            setLoading(false);\n            return;\n        };\n\n            fetchMovie();\n        }, [movieId]);\n\n        // Write to sessionStorage\n        useEffect(() => {\n            sessionStorage.setItem(movieId, JSON.stringify(state));\n        }, [movieId, state])\n\n    return { state, loading, error };\n};"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,MAAO,CAAAC,GAAG,KAAM,QAAQ,CACxB;AACA,OAASC,gBAAgB,KAAQ,YAAY,CAE7C,MAAO,MAAM,CAAAC,aAAa,CAAGC,OAAO,EAAI,CACpC,KAAM,CAACC,KAAK,CAAEC,QAAQ,CAAC,CAAGP,QAAQ,CAAC,CAAC,CAAC,CAAC,CACtC,KAAM,CAACQ,OAAO,CAAEC,UAAU,CAAC,CAAGT,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACU,KAAK,CAAEC,QAAQ,CAAC,CAAGX,QAAQ,CAAC,KAAK,CAAC,CAEzCC,SAAS,CAAE,IAAM,CACb,KAAM,CAAAW,UAAU,CAAG,KAAAA,CAAA,GAAY,CAC3B,GAAG,CACCH,UAAU,CAAC,IAAI,CAAC,CAChBE,QAAQ,CAAC,KAAK,CAAC,CAEf,KAAM,CAAAE,KAAK,CAAG,KAAM,CAAAX,GAAG,CAACU,UAAU,CAACP,OAAO,CAAC,CAC3C,KAAM,CAAAS,OAAO,CAAG,KAAM,CAAAZ,GAAG,CAACa,YAAY,CAACV,OAAO,CAAC,CAC/C;AACA,KAAM,CAAAW,SAAS,CAAGF,OAAO,CAACG,IAAI,CAACC,MAAM,CACjCC,MAAM,EAAIA,MAAM,CAACC,GAAG,GAAK,UAC7B,CAAC,CAEDb,QAAQ,CAAC,CACL,GAAGM,KAAK,CACRQ,MAAM,CAAEP,OAAO,CAACQ,IAAI,CACpBN,SACJ,CAAC,CAAC,CAEFP,UAAU,CAAC,KAAK,CAAC,CAErB,CAAE,MAAOC,KAAK,CAAE,CACZC,QAAQ,CAAC,IAAI,CAAC,CAClB,CACJ,CAAC,CAED,KAAM,CAAAY,YAAY,CAAGpB,gBAAgB,CAACE,OAAO,CAAC,CAC9C,GAAIkB,YAAY,CAAE,CACdhB,QAAQ,CAACgB,YAAY,CAAC,CACtBd,UAAU,CAAC,KAAK,CAAC,CACjB,OACJ,CAAC,CAEGG,UAAU,CAAC,CAAC,CAChB,CAAC,CAAE,CAACP,OAAO,CAAC,CAAC,CAEb;AACAJ,SAAS,CAAC,IAAM,CACZuB,cAAc,CAACC,OAAO,CAACpB,OAAO,CAAEqB,IAAI,CAACC,SAAS,CAACrB,KAAK,CAAC,CAAC,CAC1D,CAAC,CAAE,CAACD,OAAO,CAAEC,KAAK,CAAC,CAAC,CAExB,MAAO,CAAEA,KAAK,CAAEE,OAAO,CAAEE,KAAM,CAAC,CACpC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}